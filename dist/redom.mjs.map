{"version":3,"file":"redom.mjs","sources":["../src/create-element.ts","../src/html.ts","../src/unmount.ts","../src/mount.ts","../src/setstyle.ts","../src/setattr.ts","../src/text.ts","../src/util.ts","../src/dispatch.ts","../src/setchildren.ts","../src/listpool.ts","../src/list.ts","../src/place.ts","../src/ref.ts","../src/router.ts","../src/svg.ts","../src/view-factory.ts"],"sourcesContent":["export function createElement(query, ns) {\n  const { tag, id, className } = parse(query);\n  const element = ns\n    ? document.createElementNS(ns, tag)\n    : document.createElement(tag);\n\n  if (id) {\n    element.id = id;\n  }\n\n  if (className) {\n    if (ns) {\n      element.setAttribute(\"class\", className);\n    } else {\n      element.className = className;\n    }\n  }\n\n  return element;\n}\n\nfunction parse(query) {\n  const chunks = query.split(/([.#])/);\n  let className = \"\";\n  let id = \"\";\n\n  for (let i = 1; i < chunks.length; i += 2) {\n    switch (chunks[i]) {\n      case \".\":\n        className += ` ${chunks[i + 1]}`;\n        break;\n\n      case \"#\":\n        id = chunks[i + 1];\n    }\n  }\n\n  return {\n    className: className.trim(),\n    tag: chunks[0] || \"div\",\n    id,\n  };\n}\n","import { createElement } from \"./create-element\";\nimport { parseArgumentsInternal, getEl } from \"./util\";\n\nexport function html(query, ...args) {\n  let element;\n\n  const type = typeof query;\n\n  if (type === \"string\") {\n    element = createElement(query);\n  } else if (type === \"function\") {\n    const Query = query;\n    element = new Query(...args);\n  } else {\n    throw new Error(\"At least one argument required\");\n  }\n\n  parseArgumentsInternal(getEl(element), args, true);\n\n  return element;\n}\n\nexport const el = html;\nexport const h = html;\n\nhtml.extend = function extendHtml(...args) {\n  return html.bind(this, ...args);\n};\n","import { getEl } from \"./util\";\nimport { trigger } from \"./mount.ts\";\n\nexport function unmount(parent, _child) {\n  let child = _child;\n  const parentEl = getEl(parent);\n  const childEl = getEl(child);\n\n  if (child === childEl && childEl.__redom_view) {\n    // try to look up the view if not provided\n    child = childEl.__redom_view;\n  }\n\n  if (childEl.parentNode) {\n    doUnmount(child, childEl, parentEl);\n\n    parentEl.removeChild(childEl);\n  }\n\n  return child;\n}\n\nexport function doUnmount(child, childEl, parentEl) {\n  const hooks = childEl.__redom_lifecycle;\n\n  if (hooksAreEmpty(hooks)) {\n    childEl.__redom_lifecycle = {};\n    return;\n  }\n\n  let traverse = parentEl;\n\n  if (childEl.__redom_mounted) {\n    trigger(childEl, \"onunmount\");\n  }\n\n  while (traverse) {\n    const parentHooks = traverse.__redom_lifecycle || {};\n\n    for (const hook in hooks) {\n      if (parentHooks[hook]) {\n        parentHooks[hook] -= hooks[hook];\n      }\n    }\n\n    if (hooksAreEmpty(parentHooks)) {\n      traverse.__redom_lifecycle = null;\n    }\n\n    traverse = traverse.parentNode;\n  }\n}\n\nfunction hooksAreEmpty(hooks) {\n  if (hooks == null) {\n    return true;\n  }\n  for (const key in hooks) {\n    if (hooks[key]) {\n      return false;\n    }\n  }\n  return true;\n}\n","/* global Node, ShadowRoot */\n\nimport { getEl } from \"./util\";\nimport { doUnmount } from \"./unmount\";\n\nconst hookNames = [\"onmount\", \"onremount\", \"onunmount\"];\nconst shadowRootAvailable =\n  typeof window !== \"undefined\" && \"ShadowRoot\" in window;\n\nexport function mount(parent, _child, before, replace) {\n  let child = _child;\n  const parentEl = getEl(parent);\n  const childEl = getEl(child);\n\n  if (child === childEl && childEl.__redom_view) {\n    // try to look up the view if not provided\n    child = childEl.__redom_view;\n  }\n\n  if (child !== childEl) {\n    childEl.__redom_view = child;\n  }\n\n  const wasMounted = childEl.__redom_mounted;\n  const oldParent = childEl.parentNode;\n\n  if (wasMounted && oldParent !== parentEl) {\n    doUnmount(child, childEl, oldParent);\n  }\n\n  if (before != null) {\n    if (replace) {\n      const beforeEl = getEl(before);\n\n      if (beforeEl.__redom_mounted) {\n        trigger(beforeEl, \"onunmount\");\n      }\n\n      parentEl.replaceChild(childEl, beforeEl);\n    } else {\n      parentEl.insertBefore(childEl, getEl(before));\n    }\n  } else {\n    parentEl.appendChild(childEl);\n  }\n\n  doMount(child, childEl, parentEl, oldParent);\n\n  return child;\n}\n\nexport function trigger(el, eventName) {\n  if (eventName === \"onmount\" || eventName === \"onremount\") {\n    el.__redom_mounted = true;\n  } else if (eventName === \"onunmount\") {\n    el.__redom_mounted = false;\n  }\n\n  const hooks = el.__redom_lifecycle;\n\n  if (!hooks) {\n    return;\n  }\n\n  const view = el.__redom_view;\n  let hookCount = 0;\n\n  view?.[eventName]?.();\n\n  for (const hook in hooks) {\n    if (hook) {\n      hookCount++;\n    }\n  }\n\n  if (hookCount) {\n    let traverse = el.firstChild;\n\n    while (traverse) {\n      const next = traverse.nextSibling;\n\n      trigger(traverse, eventName);\n\n      traverse = next;\n    }\n  }\n}\n\nfunction doMount(child, childEl, parentEl, oldParent) {\n  if (!childEl.__redom_lifecycle) {\n    childEl.__redom_lifecycle = {};\n  }\n\n  const hooks = childEl.__redom_lifecycle;\n  const remount = parentEl === oldParent;\n  let hooksFound = false;\n\n  for (const hookName of hookNames) {\n    if (!remount) {\n      // if already mounted, skip this phase\n      if (child !== childEl) {\n        // only Views can have lifecycle events\n        if (hookName in child) {\n          hooks[hookName] = (hooks[hookName] || 0) + 1;\n        }\n      }\n    }\n    if (hooks[hookName]) {\n      hooksFound = true;\n    }\n  }\n\n  if (!hooksFound) {\n    childEl.__redom_lifecycle = {};\n    return;\n  }\n\n  let traverse = parentEl;\n  let triggered = false;\n\n  if (remount || traverse?.__redom_mounted) {\n    trigger(childEl, remount ? \"onremount\" : \"onmount\");\n    triggered = true;\n  }\n\n  while (traverse) {\n    const parent = traverse.parentNode;\n\n    if (!traverse.__redom_lifecycle) {\n      traverse.__redom_lifecycle = {};\n    }\n\n    const parentHooks = traverse.__redom_lifecycle;\n\n    for (const hook in hooks) {\n      parentHooks[hook] = (parentHooks[hook] || 0) + hooks[hook];\n    }\n\n    if (triggered) {\n      break;\n    }\n    if (\n      traverse.nodeType === Node.DOCUMENT_NODE ||\n      (shadowRootAvailable && traverse instanceof ShadowRoot) ||\n      parent?.__redom_mounted\n    ) {\n      trigger(traverse, remount ? \"onremount\" : \"onmount\");\n      triggered = true;\n    }\n    traverse = parent;\n  }\n}\n","import { getEl } from \"./util\";\n\nexport function setStyle(view, arg1, arg2) {\n  const el = getEl(view);\n\n  if (typeof arg1 === \"object\") {\n    for (const key in arg1) {\n      setStyleValue(el, key, arg1[key]);\n    }\n  } else {\n    setStyleValue(el, arg1, arg2);\n  }\n}\n\nfunction setStyleValue(el, key, value) {\n  el.style[key] = value == null ? \"\" : value;\n}\n","/* global SVGElement */\n\nimport { setStyle } from \"./setstyle\";\nimport { getEl } from \"./util\";\n\nconst xlinkns = \"http://www.w3.org/1999/xlink\";\n\nexport function setAttr(view, arg1, arg2) {\n  setAttrInternal(view, arg1, arg2);\n}\n\nexport function setAttrInternal(view, arg1, arg2, initial) {\n  const el = getEl(view);\n\n  const isObj = typeof arg1 === \"object\";\n\n  if (isObj) {\n    for (const key in arg1) {\n      setAttrInternal(el, key, arg1[key], initial);\n    }\n  } else {\n    const isSVG = el instanceof SVGElement;\n    const isFunc = typeof arg2 === \"function\";\n\n    if (arg1 === \"style\" && typeof arg2 === \"object\") {\n      setStyle(el, arg2);\n    } else if (isSVG && isFunc) {\n      el[arg1] = arg2;\n    } else if (arg1 === \"dataset\") {\n      setData(el, arg2);\n    } else if (!isSVG && (arg1 in el || isFunc) && arg1 !== \"list\") {\n      el[arg1] = arg2;\n    } else {\n      if (isSVG && arg1 === \"xlink\") {\n        setXlink(el, arg2);\n        return;\n      }\n      if (initial && arg1 === \"class\") {\n        setClassName(el, arg2);\n        return;\n      }\n      if (arg2 == null) {\n        el.removeAttribute(arg1);\n      } else {\n        el.setAttribute(arg1, arg2);\n      }\n    }\n  }\n}\n\nfunction setClassName(el, additionToClassName) {\n  if (additionToClassName == null) {\n    el.removeAttribute(\"class\");\n  } else if (el.classList) {\n    el.classList.add(additionToClassName);\n  } else if (\n    typeof el.className === \"object\" &&\n    el.className &&\n    el.className.baseVal\n  ) {\n    el.className.baseVal =\n      `${el.className.baseVal} ${additionToClassName}`.trim();\n  } else {\n    el.className = `${el.className} ${additionToClassName}`.trim();\n  }\n}\n\nexport function setXlink(el, arg1, arg2) {\n  if (typeof arg1 === \"object\") {\n    for (const key in arg1) {\n      setXlink(el, key, arg1[key]);\n    }\n  } else {\n    if (arg2 != null) {\n      el.setAttributeNS(xlinkns, arg1, arg2);\n    } else {\n      el.removeAttributeNS(xlinkns, arg1, arg2);\n    }\n  }\n}\n\nexport function setData(el, arg1, arg2) {\n  if (typeof arg1 === \"object\") {\n    for (const key in arg1) {\n      setData(el, key, arg1[key]);\n    }\n  } else {\n    if (arg2 != null) {\n      el.dataset[arg1] = arg2;\n    } else {\n      delete el.dataset[arg1];\n    }\n  }\n}\n","export function text(str) {\n  return document.createTextNode(str != null ? str : \"\");\n}\n","import { html } from \"./html.ts\";\nimport { mount } from \"./mount.ts\";\nimport { setAttrInternal } from \"./setattr.ts\";\nimport { text } from \"./text.ts\";\n\nexport function parseArguments(element, args) {\n  parseArgumentsInternal(element, args);\n}\n\nexport function parseArgumentsInternal(element, args, initial) {\n  for (const arg of args) {\n    if (arg !== 0 && !arg) {\n      continue;\n    }\n\n    const type = typeof arg;\n\n    if (type === \"function\") {\n      arg(element);\n    } else if (type === \"string\" || type === \"number\") {\n      element.appendChild(text(arg));\n    } else if (isNode(getEl(arg))) {\n      mount(element, arg);\n    } else if (arg.length) {\n      parseArgumentsInternal(element, arg, initial);\n    } else if (type === \"object\") {\n      setAttrInternal(element, arg, null, initial);\n    }\n  }\n}\n\nexport function ensureEl(parent) {\n  return typeof parent === \"string\" ? html(parent) : getEl(parent);\n}\n\nexport function getEl(parent) {\n  return (\n    (parent.nodeType && parent) || (!parent.el && parent) || getEl(parent.el)\n  );\n}\n\nexport function isNode(arg) {\n  return arg?.nodeType;\n}\n","import { getEl } from \"./util\";\n\nexport function dispatch(child, data, eventName = \"redom\") {\n  const childEl = getEl(child);\n  const event = new CustomEvent(eventName, { bubbles: true, detail: data });\n  childEl.dispatchEvent(event);\n}\n","import { mount } from \"./mount.ts\";\nimport { unmount } from \"./unmount\";\nimport { getEl, isNode } from \"./util\";\n\nexport function setChildren(parent, ...children) {\n  const parentEl = getEl(parent);\n  let current = traverse(parent, children, parentEl.firstChild);\n\n  while (current) {\n    const next = current.nextSibling;\n\n    unmount(parent, current);\n\n    current = next;\n  }\n}\n\nfunction traverse(parent, children, _current) {\n  let current = _current;\n\n  const childEls = Array(children.length);\n\n  for (let i = 0; i < children.length; i++) {\n    childEls[i] = children[i] && getEl(children[i]);\n  }\n\n  for (let i = 0; i < children.length; i++) {\n    const child = children[i];\n\n    if (!child) {\n      continue;\n    }\n\n    const childEl = childEls[i];\n\n    if (childEl === current) {\n      current = current.nextSibling;\n      continue;\n    }\n\n    if (isNode(childEl)) {\n      const next = current?.nextSibling;\n      const exists = child.__redom_index != null;\n      const replace = exists && next === childEls[i + 1];\n\n      mount(parent, child, current, replace);\n\n      if (replace) {\n        current = next;\n      }\n\n      continue;\n    }\n\n    if (child.length != null) {\n      current = traverse(parent, child, current);\n    }\n  }\n\n  return current;\n}\n","import { getEl } from \"./util\";\n\nexport function listPool(View, key, initData) {\n  return new ListPool(View, key, initData);\n}\n\nexport class ListPool {\n  constructor(View, key, initData) {\n    this.View = View;\n    this.initData = initData;\n    this.oldLookup = {};\n    this.lookup = {};\n    this.oldViews = [];\n    this.views = [];\n\n    if (key != null) {\n      this.key = typeof key === \"function\" ? key : propKey(key);\n    }\n  }\n\n  update(data, context) {\n    const { View, key, initData } = this;\n    const keySet = key != null;\n\n    const oldLookup = this.lookup;\n    const newLookup = {};\n\n    const newViews = Array(data.length);\n    const oldViews = this.views;\n\n    for (let i = 0; i < data.length; i++) {\n      const item = data[i];\n      let view;\n\n      if (keySet) {\n        const id = key(item);\n\n        view = oldLookup[id] || new View(initData, item, i, data);\n        newLookup[id] = view;\n        view.__redom_id = id;\n      } else {\n        view = oldViews[i] || new View(initData, item, i, data);\n      }\n      view.update?.(item, i, data, context);\n\n      const el = getEl(view.el);\n\n      el.__redom_view = view;\n      newViews[i] = view;\n    }\n\n    this.oldViews = oldViews;\n    this.views = newViews;\n\n    this.oldLookup = oldLookup;\n    this.lookup = newLookup;\n  }\n}\n\nfunction propKey(key) {\n  return function proppedKey(item) {\n    return item[key];\n  };\n}\n","import { setChildren } from \"./setchildren\";\nimport { ensureEl } from \"./util\";\nimport { unmount } from \"./unmount\";\nimport { ListPool } from \"./listpool\";\n\nexport function list(parent, View, key, initData) {\n  return new List(parent, View, key, initData);\n}\n\nexport class List {\n  constructor(parent, View, key, initData) {\n    this.View = View;\n    this.initData = initData;\n    this.views = [];\n    this.pool = new ListPool(View, key, initData);\n    this.el = ensureEl(parent);\n    this.keySet = key != null;\n  }\n\n  update(data, context) {\n    const { keySet } = this;\n    const oldViews = this.views;\n\n    this.pool.update(data || [], context);\n\n    const { views, lookup } = this.pool;\n\n    if (keySet) {\n      for (let i = 0; i < oldViews.length; i++) {\n        const oldView = oldViews[i];\n        const id = oldView.__redom_id;\n\n        if (lookup[id] == null) {\n          oldView.__redom_index = null;\n          unmount(this, oldView);\n        }\n      }\n    }\n\n    for (let i = 0; i < views.length; i++) {\n      const view = views[i];\n\n      view.__redom_index = i;\n    }\n\n    setChildren(this, views);\n\n    if (keySet) {\n      this.lookup = lookup;\n    }\n    this.views = views;\n  }\n}\n\nList.extend = function extendList(parent, View, key, initData) {\n  return List.bind(List, parent, View, key, initData);\n};\n\nlist.extend = List.extend;\n","/* global Node */\n\nimport { text } from \"./text\";\nimport { mount } from \"./mount.ts\";\nimport { unmount } from \"./unmount\";\nimport { getEl } from \"./util\";\n\nexport function place(View, initData) {\n  return new Place(View, initData);\n}\n\nexport class Place {\n  constructor(View, initData) {\n    this.el = text(\"\");\n    this.visible = false;\n    this.view = null;\n    this._placeholder = this.el;\n\n    if (View instanceof Node) {\n      this._el = View;\n    } else if (View.el instanceof Node) {\n      this._el = View;\n      this.view = View;\n    } else {\n      this._View = View;\n    }\n\n    this._initData = initData;\n  }\n\n  update(visible, data) {\n    const placeholder = this._placeholder;\n    const parentNode = this.el.parentNode;\n\n    if (visible) {\n      if (!this.visible) {\n        if (this._el) {\n          mount(parentNode, this._el, placeholder);\n          unmount(parentNode, placeholder);\n\n          this.el = getEl(this._el);\n          this.visible = visible;\n        } else {\n          const View = this._View;\n          const view = new View(this._initData);\n\n          this.el = getEl(view);\n          this.view = view;\n\n          mount(parentNode, view, placeholder);\n          unmount(parentNode, placeholder);\n        }\n      }\n      this.view?.update?.(data);\n    } else {\n      if (this.visible) {\n        if (this._el) {\n          mount(parentNode, placeholder, this._el);\n          unmount(parentNode, this._el);\n\n          this.el = placeholder;\n          this.visible = visible;\n\n          return;\n        }\n        mount(parentNode, placeholder, this.view);\n        unmount(parentNode, this.view);\n\n        this.el = placeholder;\n        this.view = null;\n      }\n    }\n    this.visible = visible;\n  }\n}\n","export function ref(ctx, key, value) {\n  ctx[key] = value;\n  return value;\n}\n","/* global Node */\n\nimport { ensureEl } from \"./util\";\nimport { setChildren } from \"./setchildren\";\n\nexport function router(parent, views, initData) {\n  return new Router(parent, views, initData);\n}\n\nexport class Router {\n  constructor(parent, views, initData) {\n    this.el = ensureEl(parent);\n    this.views = views;\n    this.Views = views; // backwards compatibility\n    this.initData = initData;\n  }\n\n  update(route, data) {\n    if (route !== this.route) {\n      const views = this.views;\n      const View = views[route];\n\n      this.route = route;\n\n      if (View && (View instanceof Node || View.el instanceof Node)) {\n        this.view = View;\n      } else {\n        this.view = View && new View(this.initData, data);\n      }\n\n      setChildren(this.el, [this.view]);\n    }\n    this.view?.update?.(data, route);\n  }\n}\n","import { createElement } from \"./create-element.ts\";\nimport { parseArgumentsInternal, getEl } from \"./util\";\n\nconst ns = \"http://www.w3.org/2000/svg\";\n\nexport function svg(query, ...args) {\n  let element;\n\n  const type = typeof query;\n\n  if (type === \"string\") {\n    element = createElement(query, ns);\n  } else if (type === \"function\") {\n    const Query = query;\n    element = new Query(...args);\n  } else {\n    throw new Error(\"At least one argument required\");\n  }\n\n  parseArgumentsInternal(getEl(element), args, true);\n\n  return element;\n}\n\nexport const s = svg;\n\nsvg.extend = function extendSvg(...args) {\n  return svg.bind(this, ...args);\n};\n\nsvg.ns = ns;\n","export function viewFactory(views, key) {\n  if (!views || typeof views !== \"object\") {\n    throw new Error(\"views must be an object\");\n  }\n  if (!key || typeof key !== \"string\") {\n    throw new Error(\"key must be a string\");\n  }\n  return function factoryView(initData, item, i, data) {\n    const viewKey = item[key];\n    const View = views[viewKey];\n\n    if (View) {\n      return new View(initData, item, i, data);\n    }\n\n    throw new Error(`view ${viewKey} not found`);\n  };\n}\n"],"names":["createElement","query","ns","tag","id","className","parse","element","document","createElementNS","setAttribute","chunks","split","i","length","trim","html","args","type","Query","Error","parseArgumentsInternal","getEl","el","h","extend","extendHtml","bind","unmount","parent","_child","child","parentEl","childEl","__redom_view","parentNode","doUnmount","removeChild","hooks","__redom_lifecycle","hooksAreEmpty","traverse","__redom_mounted","trigger","parentHooks","hook","key","hookNames","shadowRootAvailable","window","mount","before","replace","wasMounted","oldParent","beforeEl","replaceChild","insertBefore","appendChild","doMount","eventName","view","hookCount","firstChild","next","nextSibling","remount","hooksFound","hookName","triggered","nodeType","Node","DOCUMENT_NODE","ShadowRoot","setStyle","arg1","arg2","setStyleValue","value","style","xlinkns","setAttr","setAttrInternal","initial","isObj","isSVG","SVGElement","isFunc","setData","setXlink","setClassName","removeAttribute","additionToClassName","classList","add","baseVal","setAttributeNS","removeAttributeNS","dataset","text","str","createTextNode","arg","isNode","ensureEl","dispatch","data","event","CustomEvent","bubbles","detail","dispatchEvent","setChildren","children","current","_current","childEls","Array","exists","__redom_index","listPool","View","initData","ListPool","update","context","keySet","oldLookup","lookup","newLookup","newViews","oldViews","views","item","__redom_id","constructor","propKey","proppedKey","list","List","pool","oldView","extendList","place","Place","visible","placeholder","_placeholder","_el","_View","_initData","ref","ctx","router","Router","route","Views","svg","s","extendSvg","viewFactory","factoryView","viewKey"],"mappings":"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"}