!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).redom={})}(this,(function(e){"use strict";function t(e,t){var i=function(e){for(var t=e.split(/([.#])/),i="",n="",o=1;o<t.length;o+=2)switch(t[o]){case".":i+=" "+t[o+1];break;case"#":n=t[o+1]}return{className:i.trim(),tag:t[0]||"div",id:n}}(e),n=i.tag,o=i.id,r=i.className,s=t?document.createElementNS(t,n):document.createElement(n);return o&&(s.id=o),r&&(t?s.setAttribute("class",r):s.className=r),s}function i(e){for(var i,n=[],o=arguments.length-1;o-- >0;)n[o]=arguments[o+1];var r=typeof e;if("string"===r)i=t(e);else{if("function"!==r)throw new Error("At least one argument required");var s=e;i=new(Function.prototype.bind.apply(s,[null].concat(n)))}return y(g(i),n,!0),i}var n=i,o=i;function r(e,t){var i=g(e),n=g(t);return t===n&&n.__redom_view&&(t=n.__redom_view),n.parentNode&&(s(t,n,i),i.removeChild(n)),t}function s(e,t,i){var n=t.__redom_lifecycle;if(l(n))t.__redom_lifecycle={};else{var o=i;for(t.__redom_mounted&&d(t,"onunmount");o;){var r=o.__redom_lifecycle||{};for(var s in n)r[s]&&(r[s]-=n[s]);l(r)&&(o.__redom_lifecycle=null),o=o.parentNode}}}function l(e){if(null==e)return!0;for(var t in e)if(e[t])return!1;return!0}i.extend=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return i.bind.apply(i,[this].concat(e))};var a=["onmount","onremount","onunmount"],u="undefined"!=typeof window&&"ShadowRoot"in window;function f(e,t,i,n){var o=g(e),r=g(t);t===r&&r.__redom_view&&(t=r.__redom_view),t!==r&&(r.__redom_view=t);var l=r.__redom_mounted,f=r.parentNode;if(l&&f!==o&&s(0,r,f),null!=i)if(n){var c=g(i);c.__redom_mounted&&d(c,"onunmount"),o.replaceChild(r,c)}else o.insertBefore(r,g(i));else o.appendChild(r);return function(e,t,i,n){for(var o=t.__redom_lifecycle||(t.__redom_lifecycle={}),r=i===n,s=!1,l=0,f=a;l<f.length;l+=1){var c=f[l];r||e!==t&&c in e&&(o[c]=(o[c]||0)+1),o[c]&&(s=!0)}if(!s)return void(t.__redom_lifecycle={});var v=i,h=!1;(r||v&&v.__redom_mounted)&&(d(t,r?"onremount":"onmount"),h=!0);for(;v;){var _=v.parentNode,m=v.__redom_lifecycle||(v.__redom_lifecycle={});for(var p in o)m[p]=(m[p]||0)+o[p];if(h)break;(v.nodeType===Node.DOCUMENT_NODE||u&&v instanceof ShadowRoot||_&&_.__redom_mounted)&&(d(v,r?"onremount":"onmount"),h=!0),v=_}}(t,r,o,f),t}function d(e,t){"onmount"===t||"onremount"===t?e.__redom_mounted=!0:"onunmount"===t&&(e.__redom_mounted=!1);var i=e.__redom_lifecycle;if(i){var n=e.__redom_view,o=0;for(var r in n&&n[t]&&n[t](),i)r&&o++;if(o)for(var s=e.firstChild;s;){var l=s.nextSibling;d(s,t),s=l}}}function c(e,t,i){var n=g(e);if("object"==typeof t)for(var o in t)v(n,o,t[o]);else v(n,t,i)}function v(e,t,i){e.style[t]=null==i?"":i}var h="http://www.w3.org/1999/xlink";function _(e,t,i,n){var o=g(e);if("object"==typeof t)for(var r in t)_(o,r,t[r],n);else{var s=o instanceof SVGElement,l="function"==typeof i;if("style"===t&&"object"==typeof i)c(o,i);else if(s&&l)o[t]=i;else if("dataset"===t)p(o,i);else if(s||!(t in o)&&!l||"list"===t){if(s&&"xlink"===t)return void m(o,i);if(n&&"class"===t)return void function(e,t){null==t?e.removeAttribute("class"):e.classList?e.classList.add(t):"object"==typeof e.className&&e.className&&e.className.baseVal?e.className.baseVal=(e.className.baseVal+" "+t).trim():e.className=(e.className+" "+t).trim()}(o,i);null==i?o.removeAttribute(t):o.setAttribute(t,i)}else o[t]=i}}function m(e,t,i){if("object"==typeof t)for(var n in t)m(e,n,t[n]);else null!=i?e.setAttributeNS(h,t,i):e.removeAttributeNS(h,t,i)}function p(e,t,i){if("object"==typeof t)for(var n in t)p(e,n,t[n]);else null!=i?e.dataset[t]=i:delete e.dataset[t]}function w(e){return document.createTextNode(null!=e?e:"")}function y(e,t,i){for(var n=0,o=t;n<o.length;n+=1){var r=o[n];if(0===r||r){var s=typeof r;"function"===s?r(e):"string"===s||"number"===s?e.appendChild(w(r)):N(g(r))?f(e,r):r.length?y(e,r,i):"object"===s&&_(e,r,null,i)}}}function b(e){return"string"==typeof e?i(e):g(e)}function g(e){return e.nodeType&&e||!e.el&&e||g(e.el)}function N(e){return e&&e.nodeType}function x(e){for(var t=[],i=arguments.length-1;i-- >0;)t[i]=arguments[i+1];for(var n=k(e,t,g(e).firstChild);n;){var o=n.nextSibling;r(e,n),n=o}}function k(e,t,i){for(var n=i,o=Array(t.length),r=0;r<t.length;r++)o[r]=t[r]&&g(t[r]);for(var s=0;s<t.length;s++){var l=t[s];if(l){var a=o[s];if(a!==n)if(N(a)){var u=n&&n.nextSibling,d=null!=l.__redom_index&&u===o[s+1];f(e,l,n,d),d&&(n=u)}else null!=l.length&&(n=k(e,l,n));else n=n.nextSibling}}return n}var S=function(e,t,i){this.View=e,this.initData=i,this.oldLookup={},this.lookup={},this.oldViews=[],this.views=[],null!=t&&(this.key="function"==typeof t?t:function(e){return function(t){return t[e]}}(t))};function E(e,t,i,n){return new V(e,t,i,n)}S.prototype.update=function(e,t){for(var i=this,n=i.View,o=i.key,r=i.initData,s=null!=o,l=this.lookup,a={},u=Array(e.length),f=this.views,d=0;d<e.length;d++){var c=e[d],v=void 0;if(s){var h=o(c);v=l[h]||new n(r,c,d,e),a[h]=v,v.__redom_id=h}else v=f[d]||new n(r,c,d,e);v.update&&v.update(c,d,e,t),g(v.el).__redom_view=v,u[d]=v}this.oldViews=f,this.views=u,this.oldLookup=l,this.lookup=a};var V=function(e,t,i,n){this.View=t,this.initData=n,this.views=[],this.pool=new S(t,i,n),this.el=b(e),this.keySet=null!=i};V.prototype.update=function(e,t){void 0===e&&(e=[]);var i=this.keySet,n=this.views;this.pool.update(e,t);var o=this.pool,s=o.views,l=o.lookup;if(i)for(var a=0;a<n.length;a++){var u=n[a];null==l[u.__redom_id]&&(u.__redom_index=null,r(this,u))}for(var f=0;f<s.length;f++){s[f].__redom_index=f}x(this,s),i&&(this.lookup=l),this.views=s},V.extend=function(e,t,i,n){return V.bind(V,e,t,i,n)},E.extend=V.extend;var A=function(e,t){this.el=w(""),this.visible=!1,this.view=null,this._placeholder=this.el,e instanceof Node?this._el=e:e.el instanceof Node?(this._el=e,this.view=e):this._View=e,this._initData=t};A.prototype.update=function(e,t){var i=this._placeholder,n=this.el.parentNode;if(e){if(!this.visible)if(this._el)f(n,this._el,i),r(n,i),this.el=g(this._el),this.visible=e;else{var o=new(0,this._View)(this._initData);this.el=g(o),this.view=o,f(n,o,i),r(n,i)}this.view&&this.view.update&&this.view.update(t)}else if(this.visible){if(this._el)return f(n,i,this._el),r(n,this._el),this.el=i,void(this.visible=e);f(n,i,this.view),r(n,this.view),this.el=i,this.view=null}this.visible=e};var j=function(e,t,i){this.el=b(e),this.views=t,this.Views=t,this.initData=i};j.prototype.update=function(e,t){if(e!==this.route){var i=this.views[e];this.route=e,i&&(i instanceof Node||i.el instanceof Node)?this.view=i:this.view=i&&new i(this.initData,t),x(this.el,[this.view])}this.view&&this.view.update&&this.view.update(t,e)};var D="http://www.w3.org/2000/svg";function C(e){for(var i,n=[],o=arguments.length-1;o-- >0;)n[o]=arguments[o+1];var r=typeof e;if("string"===r)i=t(e,D);else{if("function"!==r)throw new Error("At least one argument required");var s=e;i=new(Function.prototype.bind.apply(s,[null].concat(n)))}return y(g(i),n,!0),i}var T=C;C.extend=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return C.bind.apply(C,[this].concat(e))},C.ns=D,e.List=V,e.ListPool=S,e.Place=A,e.Router=j,e.dispatch=function(e,t,i){void 0===i&&(i="redom");var n=g(e),o=new CustomEvent(i,{bubbles:!0,detail:t});n.dispatchEvent(o)},e.el=n,e.h=o,e.html=i,e.list=E,e.listPool=function(e,t,i){return new S(e,t,i)},e.mount=f,e.place=function(e,t){return new A(e,t)},e.router=function(e,t,i){return new j(e,t,i)},e.s=T,e.setAttr=function(e,t,i){_(e,t,i)},e.setChildren=x,e.setData=p,e.setStyle=c,e.setXlink=m,e.svg=C,e.text=w,e.unmount=r,e.viewFactory=function(e,t){if(!e||"object"!=typeof e)throw new Error("views must be an object");if(!t||"string"!=typeof t)throw new Error("key must be a string");return function(i,n,o,r){var s=n[t],l=e[s];if(l)return new l(i,n,o,r);throw new Error("view "+s+" not found")}}}));