!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e=e||self).redom={})}(this,function(e){"use strict";var t="#".charCodeAt(0),i=".".charCodeAt(0),n=0,r=1,o=2;function l(e,l){var s=function(e){for(var l=null,s=null,u=null,a=n,f=0,d=0;d<=e.length;d++){var h=e.charCodeAt(d),v=h===t,c=h===i;(v||c||!h)&&(a===n?l=0===d?"div":e.substring(f,d):a===r?s=e.substring(f,d):u?u+=" "+e.substring(f,d):u=e.substring(f,d),v?a=r:c&&(a=o),f=d+1)}return{tag:l,id:s,className:u}}(e),u=s.tag,a=s.id,f=s.className,d=l?document.createElementNS(l,u):document.createElement(u);return a&&(d.id=a),f&&(l?d.setAttribute("class",f):d.className=f),d}function s(e,t){var i=g(e),n=g(t);return t===n&&n.__redom_view&&(t=n.__redom_view),n.parentNode&&(u(t,n,i),i.removeChild(n)),t}function u(e,t,i){var n=t.__redom_lifecycle;if(a(n))t.__redom_mounted=!1;else{var r=i;for(t.__redom_mounted&&v(t,"onunmount");r;){var o=r.__redom_lifecycle||{};for(var l in n)o[l]&&(o[l]-=n[l]);a(o)&&(r.__redom_lifecycle=null),r=r.parentNode}}}function a(e){if(null==e)return!0;for(var t in e)if(e[t])return!1;return!0}var f=["onmount","onremount","onunmount"],d="undefined"!=typeof window&&"ShadowRoot"in window;function h(e,t,i,n){var r=g(e),o=g(t);t===o&&o.__redom_view&&(t=o.__redom_view),t!==o&&(o.__redom_view=t);var l=o.__redom_mounted,s=o.parentNode;return l&&s!==r&&u(0,o,s),null!=i?n?r.replaceChild(o,g(i)):r.insertBefore(o,g(i)):r.appendChild(o),function(e,t,i,n){for(var r=t.__redom_lifecycle||(t.__redom_lifecycle={}),o=i===n,l=!1,s=0,u=f;s<u.length;s+=1){var a=u[s];o||e!==t&&a in e&&(r[a]=(r[a]||0)+1),r[a]&&(l=!0)}if(!l)return void(t.__redom_mounted=!0);var h=i,c=!1;(o||h&&h.__redom_mounted)&&(v(t,o?"onremount":"onmount"),c=!0);for(;h;){var _=h.parentNode,p=h.__redom_lifecycle||(h.__redom_lifecycle={});for(var w in r)p[w]=(p[w]||0)+r[w];if(c)break;(h===document||d&&h instanceof window.ShadowRoot||_&&_.__redom_mounted)&&(v(h,o?"onremount":"onmount"),c=!0),h=_}}(t,o,r,s),t}function v(e,t){"onmount"===t||"onremount"===t?e.__redom_mounted=!0:"onunmount"===t&&(e.__redom_mounted=!1);var i=e.__redom_lifecycle;if(i){var n=e.__redom_view,r=0;for(var o in n&&n[t]&&n[t](),i)o&&r++;if(r)for(var l=e.firstChild;l;){var s=l.nextSibling;v(l,t),l=s}}}function c(e,t,i){var n=g(e);if(void 0!==i)n.style[t]=i;else if("string"==typeof t)n.setAttribute("style",t);else for(var r in t)c(n,r,t[r])}var _="http://www.w3.org/1999/xlink";function p(e,t,i){var n=g(e),r=n instanceof SVGElement,o="function"==typeof i;if(void 0!==i)if("style"===t)c(n,i);else if(r&&o)n[t]=i;else if("dataset"===t)!function(e,t){for(var i in t)e.dataset[i]=t[i]}(n,i);else if(!r&&(t in n||o))n[t]=i;else{if(r&&"xlink"===t)return void function(e,t){for(var i in t)e.setAttributeNS(_,i,t[i])}(n,i);n.setAttribute(t,i)}else for(var l in t)p(n,l,t[l])}function w(e){return document.createTextNode(null!=e?e:"")}function m(e,t){for(var i=0,n=t;i<n.length;i+=1){var r=n[i];if(0===r||r){var o=typeof r;"function"===o?r(e):"string"===o||"number"===o?e.appendChild(w(r)):b(g(r))?h(e,r):r.length?m(e,r):"object"===o&&p(e,r)}}}function y(e){return"string"==typeof e?N(e):g(e)}function g(e){return e.nodeType&&e||!e.el&&e||g(e.el)}function b(e){return e&&e.nodeType}var x={};function N(e){for(var t,i=[],n=arguments.length-1;n-- >0;)i[n]=arguments[n+1];var r=typeof e;if("string"===r)t=S(e).cloneNode(!1);else if(b(e))t=e.cloneNode(!1);else{if("function"!==r)throw new Error("At least one argument required");var o=e;t=new(Function.prototype.bind.apply(o,[null].concat(i)))}return m(g(t),i),t}var k=N,A=N;function S(e){return x[e]||(x[e]=l(e))}function C(e){for(var t=[],i=arguments.length-1;i-- >0;)t[i]=arguments[i+1];for(var n=function e(t,i,n){var r=n;var o=new Array(i.length);for(var l=0;l<i.length;l++)o[l]=i[l]&&g(i[l]);for(var s=0;s<i.length;s++){var u=i[s];if(u){var a=o[s];if(a!==r)if(b(a)){var f=r&&r.nextSibling,d=null!=u.__redom_index,v=d&&f===o[s+1];h(t,u,r,v),v&&(r=f)}else null!=u.length&&(r=e(t,u,r));else r=r.nextSibling}}return r}(e,t,g(e).firstChild);n;){var r=n.nextSibling;s(e,n),n=r}}N.extend=function(e){for(var t=[],i=arguments.length-1;i-- >0;)t[i]=arguments[i+1];var n=S(e);return N.bind.apply(N,[this,n].concat(t))};var V=function(e,t,i){this.View=e,this.initData=i,this.oldLookup={},this.lookup={},this.oldViews=[],this.views=[],null!=t&&(this.key="function"==typeof t?t:function(e){return function(t){return t[e]}}(t))};function D(e,t,i,n){return new E(e,t,i,n)}V.prototype.update=function(e,t){for(var i=this.View,n=this.key,r=this.initData,o=null!=n,l=this.lookup,s={},u=new Array(e.length),a=this.views,f=0;f<e.length;f++){var d=e[f],h=void 0;if(o){var v=n(d);h=l[v]||new i(r,d,f,e),s[v]=h,h.__redom_id=v}else h=a[f]||new i(r,d,f,e);h.update&&h.update(d,f,e,t),g(h.el).__redom_view=h,u[f]=h}this.oldViews=a,this.views=u,this.oldLookup=l,this.lookup=s};var E=function(e,t,i,n){this.__redom_list=!0,this.View=t,this.initData=n,this.views=[],this.pool=new V(t,i,n),this.el=y(e),this.keySet=null!=i};E.prototype.update=function(e,t){void 0===e&&(e=[]);var i=this.keySet,n=this.views;this.pool.update(e,t);var r=this.pool,o=r.views,l=r.lookup;if(i)for(var u=0;u<n.length;u++){var a=n[u];null==l[a.__redom_id]&&(a.__redom_index=null,s(this,a))}for(var f=0;f<o.length;f++){o[f].__redom_index=f}C(this,o),i&&(this.lookup=l),this.views=o},E.extend=function(e,t,i,n){return E.bind(E,e,t,i,n)},D.extend=E.extend;var L=function(e,t){this.el=w(""),this.visible=!1,this.view=null,this._placeholder=this.el,e instanceof Node?this._el=e:this._View=e,this._initData=t};L.prototype.update=function(e,t){var i=this._placeholder,n=this.el.parentNode;if(e){if(!this.visible){if(this._el)return h(n,this._el,i),s(n,i),this.el=this._el,void(this.visible=e);var r=new(0,this._View)(this._initData);this.el=g(r),this.view=r,h(n,r,i),s(n,i)}this.view&&this.view.update&&this.view.update(t)}else if(this.visible){if(this._el)return h(n,i,this._el),s(n,this._el),this.el=i,void(this.visible=e);h(n,i,this.view),s(n,this.view),this.el=i,this.view=null}this.visible=e};var P=function(e,t,i){this.el=y(e),this.Views=t,this.initData=i};P.prototype.update=function(e,t){if(e!==this.route){var i=this.Views[e];this.route=e,this.view=i&&new i(this.initData,t),C(this.el,[this.view])}this.view&&this.view.update&&this.view.update(t,e)};var j="http://www.w3.org/2000/svg",R={};function T(e){for(var t,i=[],n=arguments.length-1;n-- >0;)i[n]=arguments[n+1];var r=typeof e;if("string"===r)t=F(e).cloneNode(!1);else if(b(e))t=e.cloneNode(!1);else{if("function"!==r)throw new Error("At least one argument required");var o=e;t=new(Function.prototype.bind.apply(o,[null].concat(i)))}return m(g(t),i),t}var q=T;function F(e){return R[e]||(R[e]=l(e,j))}T.extend=function(e){var t=F(e);return T.bind(this,t)},T.ns=j,e.el=k,e.h=A,e.html=N,e.list=D,e.List=E,e.listPool=function(e,t,i){return new V(e,t,i)},e.ListPool=V,e.mount=h,e.unmount=s,e.place=function(e,t){return new L(e,t)},e.Place=L,e.router=function(e,t,i){return new P(e,t,i)},e.Router=P,e.setAttr=p,e.setStyle=c,e.setChildren=C,e.s=q,e.svg=T,e.text=w,Object.defineProperty(e,"__esModule",{value:!0})});